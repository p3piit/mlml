% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Ajnv_fun.R
\name{Ajnv_fun}
\alias{Ajnv_fun}
\title{Precompute cluster-specific inverse matrices for random-effects updates}
\usage{
Ajnv_fun(G, Z, w, D, sigma2, idx)
}
\arguments{
\item{G}{Integer. Number of clusters.}

\item{Z}{Numeric matrix (N x q). Random-effects design matrix.}

\item{w}{Numeric vector of length N. Observation-level weights.}

\item{D}{Numeric matrix (q x q). Current random-effects covariance matrix.}

\item{sigma2}{Numeric scalar. Current residual variance.}

\item{idx}{List of length G. Each element contains the row indices of \code{Z}
corresponding to a given cluster.}
}
\value{
A list of length G, where each element is a (q x q) matrix containing
\eqn{A_j^{-1}} for the corresponding cluster.
}
\description{
Computes the inverse matrices \eqn{A_j^{-1}} for each cluster \eqn{j}, where
\eqn{A_j = D^{-1} + (1 / \sigma^2) Z_j^T W_j Z_j}. These matrices are used to
speed up the closed-form updates of random effects and variance components
in the small-sample GMERT / GMERF algorithms.
}
\details{
The matrices returned by this function are used in alternative update formulas
for the random effects \eqn{b_j}, the residual variance \eqn{\sigma^2}, and the
random-effects covariance matrix \eqn{D}, reducing computational cost by
avoiding repeated matrix inversions.
}
\keyword{internal}
