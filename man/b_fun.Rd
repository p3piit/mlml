% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/b_fun.R
\name{b_fun}
\alias{b_fun}
\title{Update cluster-level random effects}
\usage{
b_fun(G, Z, Vi, D, idx, y_t, fhat, w)
}
\arguments{
\item{G}{Integer. Number of clusters.}

\item{Z}{Numeric matrix (N x q). Random-effects design matrix (stacked by cluster).}

\item{Vi}{List of length \code{G}. Each element is an \eqn{n_g \times n_g} covariance
matrix for cluster \code{g}.}

\item{D}{Numeric matrix (q x q). Random-effects covariance matrix.}

\item{idx}{List of length \code{G}. Row indices for each cluster in \code{Z} / \code{y_t} / \code{fhat} / \code{w}.}

\item{y_t}{Numeric vector length N. Working (pseudo-)response.}

\item{fhat}{Numeric vector length N. Fixed-part prediction.}

\item{w}{Numeric vector length N. Working weights (typically \eqn{\mu (1-\mu)}).}
}
\value{
A numeric matrix (G x q) of updated random effects.
}
\description{
Internal update step for GMERT/GMERF. Computes the cluster-specific random
effects \eqn{b_g} given current covariance components and working quantities.
}
\keyword{internal}
