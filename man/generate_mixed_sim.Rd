% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gen_sim.R
\name{generate_mixed_sim}
\alias{generate_mixed_sim}
\title{Simulate mixed-effects data with correlated random effects}
\usage{
generate_mixed_sim(
  n = 1000,
  n_groups = 20,
  n_vars = 10,
  n_random = 3,
  rho = 0.3,
  beta = NULL,
  mu = 0,
  random_slope_sd = 0.5,
  intercept_sd = 0.8,
  intercept_slope_cor = 0.1,
  slope_corr = 0.1,
  sigma = 1,
  seed = NULL,
  random_vars = NULL,
  intercept = 0
)
}
\arguments{
\item{n}{Integer. Total number of observations to generate.}

\item{n_groups}{Integer. Number of groups for group-level random effects.}

\item{n_vars}{Integer. Total number of predictors to simulate.}

\item{n_random}{Integer. Number of predictors that receive group-level random slopes.}

\item{rho}{Numeric in [0, 1). Pairwise correlation used to build a compound‑symmetry
covariance matrix for predictors (controls multicollinearity).}

\item{beta}{Numeric vector or NULL. Fixed-effect coefficients of length \code{n_vars}.
When NULL coefficients are sampled from N(0, 1).}

\item{mu}{Numeric scalar or numeric vector length \code{n_vars}. Mean(s) used when
drawing predictors; a scalar is recycled to length \code{n_vars}.}

\item{random_slope_sd}{Numeric scalar or numeric vector length \code{n_random}.
Standard deviation(s) for each random slope.}

\item{intercept_sd}{Numeric. Standard deviation for the group intercepts.}

\item{intercept_slope_cor}{Numeric scalar or numeric vector length \code{n_random}.
Correlation(s) between the intercept and each slope (in \link{-1, 1}).}

\item{slope_corr}{Numeric scalar or numeric matrix. If scalar, used as a common
pairwise correlation among slopes; if matrix, must be \verb{n_random x n_random}
and provides slope–slope correlations.}

\item{sigma}{Numeric. Residual (observation-level) standard deviation.}

\item{seed}{Integer or NULL. Optional RNG seed for reproducibility.}

\item{random_vars}{Integer vector or NULL. Indices of the predictors that receive
random slopes; if NULL random indices are selected.}

\item{intercept}{Numeric. Fixed intercept added to the linear predictor.}
}
\value{
A data.frame with columns: \code{id}, \code{group} (factor), \code{y},
and simulated predictors \code{X1}..\code{Xp}.
}
\description{
Generate a dataset for a linear mixed model with group-level random
intercepts and random slopes. Random effects for the intercept and the
slopes are drawn from a multivariate normal whose covariance matrix is
constructed from supplied standard deviations and correlations.
}
\details{
The function builds a \verb{(1 + n_random) x (1 + n_random)} random-effects
covariance matrix where the first row/column correspond to the intercept.
Off-diagonal entries between intercept and slopes are set as
\code{intercept_slope_cor * intercept_sd * slope_sd_j}. Slopes are uncorrelated
by default unless \code{slope_corr} is supplied. The covariance matrix is checked
for positive-definiteness and an error is raised if it is not valid.
}
\examples{

df <- generate_mixed_sim(
  n = 500, n_groups = 25, n_vars = 8, n_random = 2,
  rho = 0.4, random_slope_sd = c(0.4, 0.6), intercept_sd = 0.8,
  intercept_slope_cor = c(0.1, -0.2), slope_corr = 0.1, seed = 42
)
head(df)


}
