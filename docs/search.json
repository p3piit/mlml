[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2026 mlml authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Paolo Colussi. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Colussi, P. (2026). p3piit/mlml: Version 0.1.0 (Version v0.1.0) [Computer software]. https://doi.org/10.5281/zenodo.18247170","code":"@Manual{,   title = {p3piit/mlml: Version 0.1.0},   author = {Paolo Colussi},   year = {2026},   doi = {10.5281/zenodo.18247170},   url = {github.com/p3piit/mlml}, }"},{"path":"/index.html","id":"mlml","dir":"","previous_headings":"","what":"Utilities functions for my master thesis on multilevel machine learning","title":"Utilities functions for my master thesis on multilevel machine learning","text":"Multilevel Machine Learning utilities clustered data","code":""},{"path":"/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Utilities functions for my master thesis on multilevel machine learning","text":"mlml R package developed part master‚Äôs thesis multilevel machine learning. provides implementations : Generalized Mixed-Effects Regression Trees (GMERT) Generalized Mixed-Effects Random Forests (GMERF) Optimized variants using matrix precomputations Simulation utilities clustered binary data Prediction evaluation tools (e.g.¬†F1-score) package designed clustered / hierarchical data, observations grouped (e.g.¬†students within schools, patients within hospitals) fixed random effects must modeled.","code":""},{"path":"/index.html","id":"purpose-of-the-package-and-how-i-use-it","dir":"","previous_headings":"","what":"Purpose of the Package (and How I Use It)","title":"Utilities functions for my master thesis on multilevel machine learning","text":"package serves three main goals: Support thesis analysis reusable, tested code Implement methods literature transparent way Provide single entry point loads required tools multilevel ML use mlml personal research toolbox thesis work. : Loads required dependencies Gives access model-fitting functions Ensures reproducibility renv Instead loading many packages manually, rely mlml centralize everything. know usually bad practice import whole libraries single functions package, way ‚Äôll get packages need one line code","code":""},{"path":"/index.html","id":"implemented-methods","dir":"","previous_headings":"","what":"Implemented Methods","title":"Utilities functions for my master thesis on multilevel machine learning","text":"package includes:","code":""},{"path":"/index.html","id":"gmert-tree-based","dir":"","previous_headings":"Implemented Methods","what":"GMERT (Tree-based)","title":"Utilities functions for my master thesis on multilevel machine learning","text":"fit_gmert() predict_gmert() fit_gmert_small() (optimized version)","code":""},{"path":"/index.html","id":"gmerf-random-forest-based","dir":"","previous_headings":"Implemented Methods","what":"GMERF (Random Forest-based)","title":"Utilities functions for my master thesis on multilevel machine learning","text":"fit_gmerf() predict_gmerf() fit_gmerf_small() (optimized version)","code":""},{"path":"/index.html","id":"utilities","dir":"","previous_headings":"Implemented Methods","what":"Utilities","title":"Utilities functions for my master thesis on multilevel machine learning","text":"sim_data_gmert() ‚Äì simulate clustered binary data split_gmert_data() ‚Äì cluster-aware train/test split f1_fun() ‚Äì F1 score majority/minority class","code":""},{"path":"/index.html","id":"dependencies","dir":"","previous_headings":"","what":"Dependencies","title":"Utilities functions for my master thesis on multilevel machine learning","text":"package imports: tidyverse rpart ranger MASS lme4 parallel ggplot2 performance","code":""},{"path":"/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Utilities functions for my master thesis on multilevel machine learning","text":"project licensed MIT License.","code":""},{"path":"/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Utilities functions for my master thesis on multilevel machine learning","text":"implemented methods based following papers: Hajjem, Larocque & Bellavance (2011)Mixed Effects Regression Trees Clustered Data Statistics & Probability Letters, 81(4), 451‚Äì459https://doi.org/10.1016/j.spl.2010.12.003 Hajjem, Larocque & Bellavance (2017)Generalized Mixed Effects Regression Trees Statistics & Probability Letters, 126, 114‚Äì118https://doi.org/10.1016/j.spl.2017.02.033 Pellagatti et al.¬†(2021)Generalized Mixed-Effects Random Forest Statistical Analysis Data Mining, 14(3), 241‚Äì257https://doi.org/10.1002/sam.11505","code":""},{"path":"/index.html","id":"bust_in_silhouette-author","dir":"","previous_headings":"","what":"üë§ Author","title":"Utilities functions for my master thesis on multilevel machine learning","text":"Paolo Colussi Master‚Äôs student Email: p.colussi@uu.nl","code":""},{"path":"/reference/Ajnv_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Precompute cluster-specific inverse matrices for random-effects updates ‚Äî Ajnv_fun","title":"Precompute cluster-specific inverse matrices for random-effects updates ‚Äî Ajnv_fun","text":"Computes inverse matrices \\(A_j^{-1}\\) cluster \\(j\\), \\(A_j = D^{-1} + (1 / \\sigma^2) Z_j^T W_j Z_j\\). matrices used speed closed-form updates random effects variance components small-sample GMERT / GMERF algorithms.","code":""},{"path":"/reference/Ajnv_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Precompute cluster-specific inverse matrices for random-effects updates ‚Äî Ajnv_fun","text":"","code":"Ajnv_fun(G, Z, w, D, sigma2, idx)"},{"path":"/reference/Ajnv_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Precompute cluster-specific inverse matrices for random-effects updates ‚Äî Ajnv_fun","text":"G Integer. Number clusters. Z Numeric matrix (N x q). Random-effects design matrix. w Numeric vector length N. Observation-level weights. D Numeric matrix (q x q). Current random-effects covariance matrix. sigma2 Numeric scalar. Current residual variance. idx List length G. element contains row indices Z corresponding given cluster.","code":""},{"path":"/reference/Ajnv_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Precompute cluster-specific inverse matrices for random-effects updates ‚Äî Ajnv_fun","text":"list length G, element (q x q) matrix containing \\(A_j^{-1}\\) corresponding cluster.","code":""},{"path":"/reference/Ajnv_fun.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Precompute cluster-specific inverse matrices for random-effects updates ‚Äî Ajnv_fun","text":"matrices returned function used alternative update formulas random effects \\(b_j\\), residual variance \\(\\sigma^2\\), random-effects covariance matrix \\(D\\), reducing computational cost avoiding repeated matrix inversions.","code":""},{"path":"/reference/D_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Update random-effects covariance matrix D ‚Äî D_fun","title":"Update random-effects covariance matrix D ‚Äî D_fun","text":"Internal helper GMERT/GMERF. Updates random-effects covariance matrix \\(D\\) using closed-form expression based empirical second moments random effects shrinkage correction term derived conditional covariance.","code":""},{"path":"/reference/D_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update random-effects covariance matrix D ‚Äî D_fun","text":"","code":"D_fun(G, idx, b, Z, D, Vi, w)"},{"path":"/reference/D_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update random-effects covariance matrix D ‚Äî D_fun","text":"G Integer. Number clusters. idx List length G. Row indices cluster. b Numeric matrix (G x q). Current random-effects estimates. Z Numeric matrix (N x q). Random-effects design matrix. D Numeric matrix (q x q). Current random-effects covariance matrix. Vi List length G. Cluster-specific covariance matrices \\(V_i\\). w Numeric vector length N. Working weights.","code":""},{"path":"/reference/D_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update random-effects covariance matrix D ‚Äî D_fun","text":"Numeric matrix (q x q). Updated estimate random-effects covariance matrix \\(D\\).","code":""},{"path":"/reference/D_fun_small.html","id":null,"dir":"Reference","previous_headings":"","what":"Update random-effects covariance matrix using precomputed \\(A_i^{-1}\\) ‚Äî D_fun_small","title":"Update random-effects covariance matrix using precomputed \\(A_i^{-1}\\) ‚Äî D_fun_small","text":"Updates random-effects covariance matrix \\(D\\) combining outer products current random effects \\(b_i\\) corresponding precomputed inverse matrices \\(A_i^{-1}\\). function optimized (‚Äúsmall‚Äù) counterpart D_fun, avoiding direct dependence \\(V_i\\).","code":""},{"path":"/reference/D_fun_small.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update random-effects covariance matrix using precomputed \\(A_i^{-1}\\) ‚Äî D_fun_small","text":"","code":"D_fun_small(G, b, Ainv)"},{"path":"/reference/D_fun_small.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update random-effects covariance matrix using precomputed \\(A_i^{-1}\\) ‚Äî D_fun_small","text":"G Integer. Number clusters. b Numeric matrix (G x q). Current random effects, one row per cluster. Ainv List length G. element (q x q) matrix representing \\(A_i^{-1}\\) corresponding cluster.","code":""},{"path":"/reference/D_fun_small.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update random-effects covariance matrix using precomputed \\(A_i^{-1}\\) ‚Äî D_fun_small","text":"numeric (q x q) matrix giving updated estimate random-effects covariance matrix \\(D\\).","code":""},{"path":"/reference/D_fun_small.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Update random-effects covariance matrix using precomputed \\(A_i^{-1}\\) ‚Äî D_fun_small","text":"update computed $$D = \\frac{1}{G} \\sum_{=1}^G \\left( b_i b_i^T + A_i^{-1} \\right),$$ combines empirical covariance random effects shrinkage term derived inverse information matrices.","code":""},{"path":"/reference/Vi_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Build cluster-specific covariance matrices V_i ‚Äî Vi_fun","title":"Build cluster-specific covariance matrices V_i ‚Äî Vi_fun","text":"Internal helper GMERT/GMERF. cluster \\(\\), constructs \\(V_i = (W_i^{1/2} Z_i) D (W_i^{1/2} Z_i)^T + \\sigma^2 I_{n_i}\\), \\(W_i\\) diagonal working-weight matrix.","code":""},{"path":"/reference/Vi_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build cluster-specific covariance matrices V_i ‚Äî Vi_fun","text":"","code":"Vi_fun(Z, D, s2, G, idx, w)"},{"path":"/reference/Vi_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build cluster-specific covariance matrices V_i ‚Äî Vi_fun","text":"Z Numeric matrix (N x q). Random-effects design matrix (stacked cluster). D Numeric matrix (q x q). Random-effects covariance matrix. s2 Numeric scalar. Residual variance working scale. G Integer. Number clusters. idx List length G. Row indices cluster. w Numeric vector length N. Working weights.","code":""},{"path":"/reference/Vi_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build cluster-specific covariance matrices V_i ‚Äî Vi_fun","text":"list length G. element \\(n_i \\times n_i\\) covariance matrix \\(V_i\\).","code":""},{"path":"/reference/ait_stop.html","id":null,"dir":"Reference","previous_headings":"","what":"Aitken acceleration convergence check ‚Äî ait_stop","title":"Aitken acceleration convergence check ‚Äî ait_stop","text":"Internal helper GMERT/GMERF. Applies Aitken acceleration generalized log-likelihood sequence order estimate asymptotic value assess convergence based relative error criterion.","code":""},{"path":"/reference/ait_stop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aitken acceleration convergence check ‚Äî ait_stop","text":"","code":"ait_stop(gll, tol, it)"},{"path":"/reference/ait_stop.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aitken acceleration convergence check ‚Äî ait_stop","text":"gll Numeric vector. History generalized log-likelihood values (must contain least three consecutive iterations). tol Numeric scalar. Tolerance relative error extrapolated asymptote. Integer. Current iteration index (referring position gll).","code":""},{"path":"/reference/ait_stop.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aitken acceleration convergence check ‚Äî ait_stop","text":"Logical. TRUE convergence detected, FALSE otherwise.","code":""},{"path":"/reference/b_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Update cluster-level random effects ‚Äî b_fun","title":"Update cluster-level random effects ‚Äî b_fun","text":"Internal update step GMERT/GMERF. Computes cluster-specific random effects \\(b_g\\) given current covariance components working quantities.","code":""},{"path":"/reference/b_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update cluster-level random effects ‚Äî b_fun","text":"","code":"b_fun(G, Z, Vi, D, idx, y_t, fhat, w)"},{"path":"/reference/b_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update cluster-level random effects ‚Äî b_fun","text":"G Integer. Number clusters. Z Numeric matrix (N x q). Random-effects design matrix (stacked cluster). Vi List length G. element \\(n_g \\times n_g\\) covariance matrix cluster g. D Numeric matrix (q x q). Random-effects covariance matrix. idx List length G. Row indices cluster Z / y_t / fhat / w. y_t Numeric vector length N. Working (pseudo-)response. fhat Numeric vector length N. Fixed-part prediction. w Numeric vector length N. Working weights (typically \\(\\mu (1-\\mu)\\)).","code":""},{"path":"/reference/b_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update cluster-level random effects ‚Äî b_fun","text":"numeric matrix (G x q) updated random effects.","code":""},{"path":"/reference/b_fun_small.html","id":null,"dir":"Reference","previous_headings":"","what":"Update cluster-specific random effects using precomputed \\(A_i^{-1}\\) ‚Äî b_fun_small","title":"Update cluster-specific random effects using precomputed \\(A_i^{-1}\\) ‚Äî b_fun_small","text":"Computes updated random effects \\(b_i\\) cluster \\(\\) using precomputed inverse matrices \\(A_i^{-1}\\) (typically returned Ajnv_fun). version avoids forming inverting \\(V_i\\) directly, used ‚Äúsmall‚Äù GMERT / GMERF optimization routines.","code":""},{"path":"/reference/b_fun_small.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update cluster-specific random effects using precomputed \\(A_i^{-1}\\) ‚Äî b_fun_small","text":"","code":"b_fun_small(G, Z, w, idx, y_t, fhat, Ainv, sigma2)"},{"path":"/reference/b_fun_small.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update cluster-specific random effects using precomputed \\(A_i^{-1}\\) ‚Äî b_fun_small","text":"G Integer. Number clusters. Z Numeric matrix (N x q). Random-effects design matrix. w Numeric vector length N. Observation-level weights. idx List length G. element contains row indices Z (associated vectors) corresponding given cluster. y_t Numeric vector length N. Pseudo-response (working response). fhat Numeric vector length N. Current fitted fixed-part predictions. Ainv List length G. element (q x q) matrix representing \\(A_i^{-1}\\) corresponding cluster. sigma2 Numeric scalar. Current residual variance.","code":""},{"path":"/reference/b_fun_small.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update cluster-specific random effects using precomputed \\(A_i^{-1}\\) ‚Äî b_fun_small","text":"numeric matrix dimension (G x q) containing updated random effects cluster.","code":""},{"path":"/reference/b_fun_small.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Update cluster-specific random effects using precomputed \\(A_i^{-1}\\) ‚Äî b_fun_small","text":"cluster \\(\\), function computes $$b_i = A_i^{-1} \\cdot (1/\\sigma^2) Z_i^T W_i (y^*_i - f_i)$$ \\(y^*_i\\) pseudo-response restricted cluster \\(\\), \\(f_i\\) fixed-part prediction, \\(W_i\\) diagonal matrix working weights.","code":""},{"path":"/reference/f1_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the F1-score for the majority or minority class ‚Äî f1_fun","title":"Compute the F1-score for the majority or minority class ‚Äî f1_fun","text":"Computes F1-score 2x2 confusion matrix, either majority class (default) minority class.","code":""},{"path":"/reference/f1_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the F1-score for the majority or minority class ‚Äî f1_fun","text":"","code":"f1_fun(table, majority = TRUE)"},{"path":"/reference/f1_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the F1-score for the majority or minority class ‚Äî f1_fun","text":"table 2x2 confusion matrix (e.g., produced table(y, yhat)), rows correspond true classes columns predicted classes. majority Logical. TRUE, compute F1-score majority class; FALSE, compute minority class.","code":""},{"path":"/reference/f1_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the F1-score for the majority or minority class ‚Äî f1_fun","text":"numeric scalar giving F1-score selected class.","code":""},{"path":"/reference/f1_fun.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the F1-score for the majority or minority class ‚Äî f1_fun","text":"","code":"# Example confusion matrix cm <- matrix(c(50, 10,                5,  35), nrow = 2, byrow = TRUE)  # F1-score for the majority class f1_fun(cm, majority = TRUE) #> [1] 0.8695652  # F1-score for the minority class f1_fun(cm, majority = FALSE) #> [1] 0.8235294"},{"path":"/reference/fit_gmerf.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a Generalized Mixed-Effects Random Forest model (GMERF) ‚Äî fit_gmerf","title":"Fit a Generalized Mixed-Effects Random Forest model (GMERF) ‚Äî fit_gmerf","text":"Fits Generalized Mixed-Effects Random Forest (GMERF) model clustered binary outcomes using iterative PQL (outer loop) + EM-like (inner loop) scheme. fixed-effects component estimated via regression random forest, random-effects component updated closed-form updates \\(b\\), \\(D\\), \\(\\sigma^2\\).","code":""},{"path":"/reference/fit_gmerf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a Generalized Mixed-Effects Random Forest model (GMERF) ‚Äî fit_gmerf","text":"","code":"fit_gmerf(   df,   id = \"id\",   target = \"y\",   random_effects = \"x1\",   max_iter_inn = 1000,   max_iter_out = 1000,   tol = 1e-06,   ntrees = 500,   mtry = NULL,   min_node_size = 5,   max.depth = NULL,   seed = 1234 )"},{"path":"/reference/fit_gmerf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a Generalized Mixed-Effects Random Forest model (GMERF) ‚Äî fit_gmerf","text":"df data.frame containing clustered data. id Character. Name cluster identifier column df. target Character. Name binary response column df. random_effects Character. Name covariate used random slope; random-effects design [1, random_effects] (random intercept + random slope). max_iter_inn Integer. Maximum number inner-loop (EM-like) iterations. max_iter_out Integer. Maximum number outer-loop (PQL) iterations. tol Numeric. Convergence tolerance used loops. ntrees Integer. Number trees random forest. mtry Integer NULL. Number predictors tried split random forest. NULL, ranger defaults used. min_node_size Integer. Minimum terminal node size random forest. max.depth Integer NULL. Maximum depth trees random forest; NULL means unlimited. seed Integer. Random seed passed random forest fitting routine.","code":""},{"path":"/reference/fit_gmerf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a Generalized Mixed-Effects Random Forest model (GMERF) ‚Äî fit_gmerf","text":"list containing: forest: fitted ranger forest object (rf$forest) b: estimated random effects matrix (G x q) D: estimated random-effects covariance matrix (q x q) sigma2: estimated residual variance mu: fitted conditional means (length N) converged_in: logical vector inner-loop convergence flags (one per outer iteration) converged_out: logical flag outer-loop convergence n_iter: number inner-loop iterations performed last outer step train_ids: cluster identifiers used training (copied df[[id]]) gll: trace generalized log-likelihood values (diagnostics) tol: convergence tolerance used","code":""},{"path":"/reference/fit_gmerf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit a Generalized Mixed-Effects Random Forest model (GMERF) ‚Äî fit_gmerf","text":"implementation follows generalized mixed-effects regression tree / forest framework, fixed-effects learner replaced random forest (see References). routine relies helper functions Vi_fun(), b_fun(), sigma_fun(), D_fun(), gll_fun() mixed-effects updates, uses ranger::ranger() fixed-effects regression learner.","code":""},{"path":"/reference/fit_gmerf.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit a Generalized Mixed-Effects Random Forest model (GMERF) ‚Äî fit_gmerf","text":"Hajjem, Ahlem, Fran√ßois Bellavance, Denis Larocque. 2011. ‚ÄúMixed Effects Regression Trees Clustered Data.‚Äù Statistics & Probability Letters 81 (4): 451‚Äì59. doi:10.1016/j.spl.2010.12.003 . Hajjem, Ahlem, Denis Larocque, Fran√ßois Bellavance. 2017. ‚ÄúGeneralized Mixed Effects Regression Trees.‚Äù Statistics & Probability Letters 126 (July): 114‚Äì18. doi:10.1016/j.spl.2017.02.033 . Pellagatti, Massimo, Chiara Masci, Francesca Ieva, Anna M. Paganoni. 2021. ‚ÄúGeneralized Mixed-Effects Random Forest: Flexible Approach Predict University Student Dropout.‚Äù Statistical Analysis Data Mining: ASA Data Science Journal 14 (3): 241‚Äì57. doi:10.1002/sam.11505 .","code":""},{"path":[]},{"path":"/reference/fit_gmerf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a Generalized Mixed-Effects Random Forest model (GMERF) ‚Äî fit_gmerf","text":"","code":"library(ranger) library(MASS) # Simulate clustered binary data df <- sim_data_gmert(G = 20, n_i = 30, seed = 1)  # Fit GMERF fit <- fit_gmerf(df, ntrees = 200, seed = 1, max_iter_out = 50) #> WARNING: the PQL algorithm did not converge in 50 iterations.  # Inspect convergence fit$converged_out #> [1] FALSE"},{"path":"/reference/fit_gmerf_small.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a generalized mixed-effects random forest (GMERF) using A-inverse updates ‚Äî fit_gmerf_small","title":"Fit a generalized mixed-effects random forest (GMERF) using A-inverse updates ‚Äî fit_gmerf_small","text":"Fits generalized mixed-effects model fixed-effects component learned via random forest random effects account clustered/longitudinal dependence. Estimation proceeds via PQL outer loop EM-like inner loop, using precomputed cluster-specific \\(A_i^{-1}\\) matrices update random effects variance components efficiently.","code":""},{"path":"/reference/fit_gmerf_small.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a generalized mixed-effects random forest (GMERF) using A-inverse updates ‚Äî fit_gmerf_small","text":"","code":"fit_gmerf_small(   df,   id = \"id\",   target = \"y\",   random_effects = \"x1\",   max_iter_inn = 1000,   max_iter_out = 1000,   tol = 1e-06,   ntrees = 500,   mtry = NULL,   min_node_size = 5,   max.depth = NULL,   seed = 1234,   num.threads = NULL )"},{"path":"/reference/fit_gmerf_small.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a generalized mixed-effects random forest (GMERF) using A-inverse updates ‚Äî fit_gmerf_small","text":"df data.frame containing response, cluster identifier, random-effect covariate(s), fixed-effect predictors. id Character scalar. Name clustering/grouping variable df. target Character scalar. Name binary response variable df. random_effects Character scalar. Name(s) variable(s) used random-effects design (intercept added internally). max_iter_inn Integer. Maximum number EM-like iterations (inner loop). max_iter_out Integer. Maximum number PQL iterations (outer loop). tol Numeric. Convergence tolerance used inner outer loops. ntrees Integer. Number trees random forest. mtry Integer NULL. Number candidate features tried split (passed ranger::ranger; NULL uses ranger's default). min_node_size Integer. Minimum terminal node size forest. max.depth Integer NULL. Maximum tree depth forest (NULL = unlimited). seed Integer. Random seed reproducibility. num.threads Integer NULL. Number threads used ranger (NULL uses available threads).","code":""},{"path":"/reference/fit_gmerf_small.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a generalized mixed-effects random forest (GMERF) using A-inverse updates ‚Äî fit_gmerf_small","text":"list components: forest Fitted random forest object (stored rf$forest). b Matrix estimated random effects (clusters x q). D Estimated random-effects covariance matrix. sigma2 Estimated residual variance. mu Fitted conditional means. converged_in Logical vector inner-loop convergence flags (per outer iteration). converged_out Logical flag outer-loop convergence. n_iter Number inner-loop iterations performed last outer iteration. train_ids Cluster identifiers used training. gll Generalized log-likelihood trace used diagnostics. tol Tolerance used convergence checks.","code":""},{"path":"/reference/fit_gmerf_small.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit a generalized mixed-effects random forest (GMERF) using A-inverse updates ‚Äî fit_gmerf_small","text":"Hajjem, Ahlem, Fran√ßois Bellavance, Denis Larocque. 2011. ‚ÄúMixed Effects Regression Trees Clustered Data.‚Äù Statistics & Probability Letters 81 (4): 451‚Äì59. doi:10.1016/j.spl.2010.12.003 . Hajjem, Ahlem, Denis Larocque, Fran√ßois Bellavance. 2017. ‚ÄúGeneralized Mixed Effects Regression Trees.‚Äù Statistics & Probability Letters 126 (July): 114‚Äì18. doi:10.1016/j.spl.2017.02.033 . Pellagatti, Massimo, Chiara Masci, Francesca Ieva, Anna M. Paganoni. 2021. ‚ÄúGeneralized Mixed-Effects Random Forest: Flexible Approach Predict University Student Dropout.‚Äù Statistical Analysis Data Mining: ASA Data Science Journal 14 (3): 241‚Äì57. doi:10.1002/sam.11505 .","code":""},{"path":[]},{"path":"/reference/fit_gmerf_small.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a generalized mixed-effects random forest (GMERF) using A-inverse updates ‚Äî fit_gmerf_small","text":"","code":"# Simulate clustered binary data df <- sim_data_gmert(G = 10, n_i = 30, seed = 1)  # Fit the optimized GMERF (A^{-1}-based updates) fit <- fit_gmerf_small(df, id = \"id\", target = \"y\", random_effects = \"x1\",                        max_iter_inn = 50, max_iter_out = 50, tol = 1e-4,                        ntrees = 100, seed = 1) #> WARNING: the PQL algorithm did not converge in 50 iterations.  # Predicted classes on training data pred <- predict_gmerf(fit, new_df = df, random_effects = \"x1\", id = \"id\")"},{"path":"/reference/fit_gmert.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a generalized mixed-effects regression tree (GMERT) ‚Äî fit_gmert","title":"Fit a generalized mixed-effects regression tree (GMERT) ‚Äî fit_gmert","text":"Fits generalized mixed-effects regression tree model clustered binary outcomes using PQL outer loop EM-like inner loop. fixed part estimated via rpart regression tree working pseudo-response, random part modeled cluster-specific random intercepts slopes (currently implemented intercept plus one random slope).","code":""},{"path":"/reference/fit_gmert.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a generalized mixed-effects regression tree (GMERT) ‚Äî fit_gmert","text":"","code":"fit_gmert(   df,   id = \"id\",   target = \"y\",   random_effects = \"x1\",   max_iter_inn = 1000,   max_iter_out = 1000,   tol = 1e-06,   cp = 0,   minsplit = 50,   minbucket = 20,   maxdepth = 5,   xval = 10 )"},{"path":"/reference/fit_gmert.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a generalized mixed-effects regression tree (GMERT) ‚Äî fit_gmert","text":"df data frame containing response, cluster identifier, predictors. id Character string. Name cluster identifier column df. target Character string. Name binary response column df (coded 0/1). random_effects Character string. Name predictor used random slope. random-effects design built intercept plus column. max_iter_inn Integer. Maximum number EM-like inner-loop iterations. max_iter_out Integer. Maximum number PQL outer-loop iterations. tol Numeric scalar. Convergence tolerance used inner outer loops. cp Numeric scalar. rpart complexity parameter (pruning threshold). minsplit Integer. Minimum number observations required attempt split rpart. minbucket Integer. Minimum number observations terminal node rpart. maxdepth Integer. Maximum depth fitted rpart tree. xval Integer. Number cross-validation folds used rpart.","code":""},{"path":"/reference/fit_gmert.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a generalized mixed-effects regression tree (GMERT) ‚Äî fit_gmert","text":"list components: tree rpart object: fitted regression tree fixed effects. b Numeric matrix (G x q) estimated random effects cluster. D Numeric matrix (q x q): estimated random-effects covariance matrix. sigma2 Numeric scalar: estimated residual variance working scale. mu Numeric vector length N: fitted conditional means convergence. converged_in Logical vector: inner-loop convergence flag outer iteration. converged_out Logical scalar: outer-loop convergence flag. n_iter Integer: number inner iterations performed last outer iteration. train_ids Vector cluster identifiers training data. gll Numeric vector: generalized log-likelihood trace used diagnostics. tol Numeric scalar: tolerance used.","code":""},{"path":"/reference/fit_gmert.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit a generalized mixed-effects regression tree (GMERT) ‚Äî fit_gmert","text":"function returns list containing fitted tree, estimated random effects, covariance parameters, convergence diagnostics. implementation assumes binary response uses logistic link via penalized quasi-likelihood (PQL) linearization. random-effects structure currently intercept plus one slope specified random_effects.","code":""},{"path":"/reference/fit_gmert.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit a generalized mixed-effects regression tree (GMERT) ‚Äî fit_gmert","text":"Hajjem, ., Larocque, D., & Bellavance, F. (2017). Generalized mixed effects regression trees. Statistics & Probability Letters, 126, 114‚Äì118. doi:10.1016/j.spl.2017.02.033","code":""},{"path":[]},{"path":"/reference/fit_gmert.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a generalized mixed-effects regression tree (GMERT) ‚Äî fit_gmert","text":"","code":"# Simulate clustered binary data df <- sim_data_gmert(G = 10, n_i = 30, seed = 1) split <- split_gmert_data(df, train_prop = 0.7, seed = 1)  # Fit GMERT fit <- fit_gmert(split$train, id = \"id\", target = \"y\", random_effects = \"x1\",                  max_iter_inn = 50, max_iter_out = 50, tol = 1e-4,                  maxdepth = 3, minsplit = 20, minbucket = 10) #> WARNING: the PQL algorithm did not converge in 50 iterations.  # Predict on test set pred <- predict_gmert(fit, split$test, random_effect = \"x1\", id = \"id\") table(truth = split$test$y, pred = pred) #>      pred #> truth  0  1 #>     0 18 20 #>     1 10 42"},{"path":"/reference/fit_gmert_small.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a generalized mixed-effects regression tree (GMERT) using A-inverse updates ‚Äî fit_gmert_small","title":"Fit a generalized mixed-effects regression tree (GMERT) using A-inverse updates ‚Äî fit_gmert_small","text":"Fits generalized mixed-effects regression tree model clustered binary data, using optimized set updates based precomputing \\(A_i^{-1}\\) speed estimation random effects covariance variance components.","code":""},{"path":"/reference/fit_gmert_small.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a generalized mixed-effects regression tree (GMERT) using A-inverse updates ‚Äî fit_gmert_small","text":"","code":"fit_gmert_small(   df,   id = \"id\",   target = \"y\",   random_effects = \"x1\",   max_iter_inn = 1000,   max_iter_out = 1000,   tol = 1e-06,   cp = 0,   minsplit = 50,   minbucket = 20,   maxdepth = 5,   xval = 10 )"},{"path":"/reference/fit_gmert_small.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a generalized mixed-effects regression tree (GMERT) using A-inverse updates ‚Äî fit_gmert_small","text":"df data.frame containing response, cluster identifier, random-effect covariate(s), fixed-effect predictors. id Character scalar. Name clustering/grouping variable df. target Character scalar. Name binary response variable df. random_effects Character scalar. Name(s) variable(s) used random-effects design (intercept added internally). max_iter_inn Integer. Maximum number EM-like iterations (inner loop). max_iter_out Integer. Maximum number PQL iterations (outer loop). tol Numeric. Convergence tolerance used inner outer loops. cp Numeric. Complexity parameter passed rpart.control(). minsplit Integer. Minimum number observations required attempt split. minbucket Integer. Minimum number observations terminal node. maxdepth Integer. Maximum depth fitted tree. xval Integer. Number cross-validation folds rpart.","code":""},{"path":"/reference/fit_gmert_small.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a generalized mixed-effects regression tree (GMERT) using A-inverse updates ‚Äî fit_gmert_small","text":"list components: tree Fitted rpart regression tree fixed-effects component. b Matrix estimated random effects (clusters x q). D Estimated random-effects covariance matrix. sigma2 Estimated residual variance. mu Fitted conditional means. converged_in Logical vector inner-loop convergence flags (per outer iteration). converged_out Logical flag outer-loop convergence. n_iter Number inner-loop iterations performed last outer iteration. train_ids Cluster identifiers used training. gll Generalized log-likelihood trace used diagnostics. tol Tolerance used convergence checks. time Elapsed runtime seconds.","code":""},{"path":"/reference/fit_gmert_small.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit a generalized mixed-effects regression tree (GMERT) using A-inverse updates ‚Äî fit_gmert_small","text":"routine follows penalized quasi-likelihood (PQL) outer loop EM-like inner loop described GMERT, replacing direct \\(V_i^{-1}\\) computations cluster-wise precomputed \\(A_i^{-1}\\) matrices.","code":""},{"path":"/reference/fit_gmert_small.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit a generalized mixed-effects regression tree (GMERT) using A-inverse updates ‚Äî fit_gmert_small","text":"Hajjem, Ahlem, Fran√ßois Bellavance, Denis Larocque. 2011. ‚ÄúMixed Effects Regression Trees Clustered Data.‚Äù Statistics & Probability Letters 81 (4): 451‚Äì59. doi:10.1016/j.spl.2010.12.003 . Hajjem, Ahlem, Denis Larocque, Fran√ßois Bellavance. 2017. ‚ÄúGeneralized Mixed Effects Regression Trees.‚Äù Statistics & Probability Letters 126 (July): 114‚Äì18. doi:10.1016/j.spl.2017.02.033 .","code":""},{"path":[]},{"path":"/reference/fit_gmert_small.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a generalized mixed-effects regression tree (GMERT) using A-inverse updates ‚Äî fit_gmert_small","text":"","code":"# Simulate clustered binary data df <- sim_data_gmert(G = 10, n_i = 30, seed = 1)  # Fit the optimized GMERT (A^{-1}-based updates) fit <- fit_gmert_small(df, id = \"id\", target = \"y\", random_effects = \"x1\",                        max_iter_inn = 50, max_iter_out = 50, tol = 1e-4) #> WARNING: the PQL algorithm did not converge in 50 iterations.  # Predicted classes on training data pred <- predict_gmert(fit, new_df = df, random_effect = \"x1\", id = \"id\")"},{"path":"/reference/gll_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute generalized log-likelihood (up to an additive constant) ‚Äî gll_fun","title":"Compute generalized log-likelihood (up to an additive constant) ‚Äî gll_fun","text":"Internal helper GMERT/GMERF. Computes generalized log-likelihood criterion used monitoring convergence checks. returned value defined additive constant (.e., suitable comparing iterations absolute likelihood value).","code":""},{"path":"/reference/gll_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute generalized log-likelihood (up to an additive constant) ‚Äî gll_fun","text":"","code":"gll_fun(idx, b, y, Z, D, s2, fhat, w)"},{"path":"/reference/gll_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute generalized log-likelihood (up to an additive constant) ‚Äî gll_fun","text":"idx List row indices per cluster. b Numeric matrix (G x q). Random-effects estimates. y Numeric vector length N. Response pseudo-response. Z Numeric matrix (N x q). Random-effects design matrix. D Numeric matrix (q x q). Random-effects covariance matrix. s2 Numeric scalar. Residual variance. fhat Numeric vector length N. Fixed-effects predictions. w Numeric vector length N. Working weights.","code":""},{"path":"/reference/gll_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute generalized log-likelihood (up to an additive constant) ‚Äî gll_fun","text":"Numeric scalar. Generalized log-likelihood value (additive constant).","code":""},{"path":"/reference/predict_gmerf.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict class labels from a fitted GMERF model ‚Äî predict_gmerf","title":"Predict class labels from a fitted GMERF model ‚Äî predict_gmerf","text":"Generates binary predictions new clustered data using fitted Generalized Mixed-Effects Random Forest (GMERF) model. Predictions combine fixed-effects random forest component cluster-specific random effects estimated training.","code":""},{"path":"/reference/predict_gmerf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict class labels from a fitted GMERF model ‚Äî predict_gmerf","text":"","code":"predict_gmerf(fit, new_df, thr = 0.5, random_effects = \"x1\", id = \"id\")"},{"path":"/reference/predict_gmerf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict class labels from a fitted GMERF model ‚Äî predict_gmerf","text":"fit fitted GMERF model object returned fit_gmerf. new_df data.frame containing new observations prediction. thr Numeric. Classification threshold converting predicted probabilities class labels (default: 0.5). random_effects Character. Name covariate used random slope random-effects design. id Character. Name cluster identifier column new_df.","code":""},{"path":"/reference/predict_gmerf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict class labels from a fitted GMERF model ‚Äî predict_gmerf","text":"numeric vector predicted class labels (0/1).","code":""},{"path":"/reference/predict_gmerf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict class labels from a fitted GMERF model ‚Äî predict_gmerf","text":"clusters observed training data, corresponding random effects added fixed-effects prediction. unseen clusters, fixed-effects component used. linear predictor computed : $$\\eta = \\hat f(X) + Z_i \\hat b_i$$ \\(\\hat f(X)\\) random forest prediction \\(Z_i \\hat b_i\\) random-effects contribution cluster \\(\\), available.","code":""},{"path":"/reference/predict_gmerf.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Predict class labels from a fitted GMERF model ‚Äî predict_gmerf","text":"Hajjem, Ahlem, Fran√ßois Bellavance, Denis Larocque. 2011. ‚ÄúMixed Effects Regression Trees Clustered Data.‚Äù Statistics & Probability Letters 81 (4): 451‚Äì59. doi:10.1016/j.spl.2010.12.003 . Hajjem, Ahlem, Denis Larocque, Fran√ßois Bellavance. 2017. ‚ÄúGeneralized Mixed Effects Regression Trees.‚Äù Statistics & Probability Letters 126 (July): 114‚Äì18. doi:10.1016/j.spl.2017.02.033 . Pellagatti, Massimo, Chiara Masci, Francesca Ieva, Anna M. Paganoni. 2021. ‚ÄúGeneralized Mixed-Effects Random Forest: Flexible Approach Predict University Student Dropout.‚Äù Statistical Analysis Data Mining: ASA Data Science Journal 14 (3): 241‚Äì57. doi:10.1002/sam.11505 .","code":""},{"path":[]},{"path":"/reference/predict_gmerf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict class labels from a fitted GMERF model ‚Äî predict_gmerf","text":"","code":"# Simulate clustered data df <- sim_data_gmert(G = 20, n_i = 30, seed = 1)  # Fit GMERF fit <- fit_gmerf(df, ntrees = 200, seed = 1, , max_iter_out = 50) #> WARNING: the PQL algorithm did not converge in 50 iterations.  # Predict on training data yhat <- predict_gmerf(fit, df) table(yhat, df$y) #>      #> yhat   0   1 #>    0 191  37 #>    1  52 320"},{"path":"/reference/predict_gmert.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict binary outcomes from a fitted GMERT model ‚Äî predict_gmert","title":"Predict binary outcomes from a fitted GMERT model ‚Äî predict_gmert","text":"Generates cluster-aware predictions new data using fitted generalized mixed effects regression tree (GMERT) model. Predictions combine fixed-effects regression tree component estimated cluster-specific random effects available.","code":""},{"path":"/reference/predict_gmert.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict binary outcomes from a fitted GMERT model ‚Äî predict_gmert","text":"","code":"predict_gmert(fit, new_df, random_effect = \"x1\", thr = 0.5, id = \"id\")"},{"path":"/reference/predict_gmert.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict binary outcomes from a fitted GMERT model ‚Äî predict_gmert","text":"fit fitted GMERT model object returned fit_gmert(). new_df data.frame containing predictors cluster identifiers. random_effect Character. Name random-effects covariate (default: \"x1\"). thr Numeric. Classification threshold predicted probabilities. id Character. Name cluster identifier column (default: \"id\").","code":""},{"path":"/reference/predict_gmert.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict binary outcomes from a fitted GMERT model ‚Äî predict_gmert","text":"Numeric vector binary predictions (0 1).","code":""},{"path":"/reference/predict_gmert.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Predict binary outcomes from a fitted GMERT model ‚Äî predict_gmert","text":"Hajjem, ., Larocque, D., & Bellavance, F. (2017). Generalized mixed effects regression trees. Statistics & Probability Letters, 126, 114‚Äì118. doi:10.1016/j.spl.2017.02.033","code":""},{"path":[]},{"path":"/reference/predict_gmert.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict binary outcomes from a fitted GMERT model ‚Äî predict_gmert","text":"","code":"if (FALSE) { # \\dontrun{ data <- sim_data_gmert() split <- split_gmert_data(data) fit <- fit_gmert(split$train, , max_iter_out = 50) preds <- predict_gmert(fit, split$test) table(preds, split$test$y) } # }"},{"path":"/reference/sigma_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Update residual variance \\(\\sigma^2\\) ‚Äî sigma_fun","title":"Update residual variance \\(\\sigma^2\\) ‚Äî sigma_fun","text":"Internal helper GMERT/GMERF. Updates residual variance parameter \\(\\sigma^2\\) using closed-form expression derived generalized log-likelihood, aggregating cluster-wise weighted residuals.","code":""},{"path":"/reference/sigma_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update residual variance \\(\\sigma^2\\) ‚Äî sigma_fun","text":"","code":"sigma_fun(N, G, idx, b, y, Z, D, Vi, s2, fhat, w)"},{"path":"/reference/sigma_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update residual variance \\(\\sigma^2\\) ‚Äî sigma_fun","text":"N Integer. Total number observations. G Integer. Number clusters. idx List length G. Row indices cluster. b Numeric matrix (G x q). Current random-effects estimates. y Numeric vector length N. Response pseudo-response. Z Numeric matrix (N x q). Random-effects design matrix. D Numeric matrix (q x q). Random-effects covariance matrix. Vi List length G. Cluster-specific covariance matrices \\(V_i\\). s2 Numeric scalar. Current residual variance. fhat Numeric vector length N. Fixed-effects predictions. w Numeric vector length N. Working weights.","code":""},{"path":"/reference/sigma_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update residual variance \\(\\sigma^2\\) ‚Äî sigma_fun","text":"Numeric scalar. Updated estimate \\(\\sigma^2\\).","code":""},{"path":"/reference/sigma_fun_small.html","id":null,"dir":"Reference","previous_headings":"","what":"Update residual variance using precomputed \\(A_i^{-1}\\) ‚Äî sigma_fun_small","title":"Update residual variance using precomputed \\(A_i^{-1}\\) ‚Äî sigma_fun_small","text":"Updates residual variance parameter \\(\\sigma^2\\) using cluster-wise quantities precomputed matrices \\(A_i^{-1}\\) (typically obtained Ajnv_fun). ‚Äúsmall‚Äù (optimized) counterpart sigma_fun, avoiding direct formation/inversion \\(V_i\\).","code":""},{"path":"/reference/sigma_fun_small.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update residual variance using precomputed \\(A_i^{-1}\\) ‚Äî sigma_fun_small","text":"","code":"sigma_fun_small(N, G, idx, Z, w, y_t, fhat, b, Ainv, sigma2)"},{"path":"/reference/sigma_fun_small.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update residual variance using precomputed \\(A_i^{-1}\\) ‚Äî sigma_fun_small","text":"N Integer. Total number observations. G Integer. Number clusters. idx List length G. element contains row indices given cluster. Z Numeric matrix (N x q). Random-effects design matrix. w Numeric vector length N. Observation-level weights. y_t Numeric vector length N. Pseudo-response (working response). fhat Numeric vector length N. Current fitted fixed-part predictions. b Numeric matrix (G x q). Current random effects (one row per cluster). Ainv List length G. element (q x q) matrix representing \\(A_i^{-1}\\) corresponding cluster. sigma2 Numeric scalar. Current residual variance value used update.","code":""},{"path":"/reference/sigma_fun_small.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update residual variance using precomputed \\(A_i^{-1}\\) ‚Äî sigma_fun_small","text":"numeric scalar giving updated residual variance estimate.","code":""},{"path":"/reference/sigma_fun_small.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Update residual variance using precomputed \\(A_i^{-1}\\) ‚Äî sigma_fun_small","text":"update aggregates weighted residual sum squares across clusters includes trace adjustment term involving \\(\\mathrm{tr}(V_i^{-1})\\), computed efficiently via \\(A_i^{-1}\\).","code":""},{"path":"/reference/sim_data_gmert.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate clustered binary data for GMERT models ‚Äî sim_data_gmert","title":"Simulate clustered binary data for GMERT models ‚Äî sim_data_gmert","text":"Generates synthetic clustered data logistic mixed-effects model random intercepts random slopes. simulated dataset suitable fitting testing generalized mixed effects regression tree (GMERT) models.","code":""},{"path":"/reference/sim_data_gmert.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate clustered binary data for GMERT models ‚Äî sim_data_gmert","text":"","code":"sim_data_gmert(   G = 50,   n_i = 40,   beta0 = 0.5,   beta1 = 1.2,   beta2 = -0.8,   beta3 = 0.6,   sigma_b0 = 0.8,   sigma_b1 = 0.5,   rho = 0.2,   seed = 123 )"},{"path":"/reference/sim_data_gmert.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate clustered binary data for GMERT models ‚Äî sim_data_gmert","text":"G Integer. Number clusters. n_i Integer. Number observations per cluster. beta0 Numeric. Fixed intercept. beta1 Numeric. Fixed effect x1. beta2 Numeric. Fixed effect x2. beta3 Numeric. Fixed effect x3. sigma_b0 Numeric. Standard deviation random intercept. sigma_b1 Numeric. Standard deviation random slope x1. rho Numeric. Correlation random intercept random slope. seed Integer. Random seed reproducibility.","code":""},{"path":"/reference/sim_data_gmert.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate clustered binary data for GMERT models ‚Äî sim_data_gmert","text":"data.frame columns id, y, x1, x2, x3.","code":""},{"path":[]},{"path":"/reference/sim_data_gmert.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate clustered binary data for GMERT models ‚Äî sim_data_gmert","text":"","code":"data <- sim_data_gmert() head(data) #>   id y          x1         x2 x3 #> 1  1 1 -1.04509589  0.9159921  1 #> 2  1 1  1.84943575  0.8006224  1 #> 3  1 0  0.40546290 -0.9365690  0 #> 4  1 1  0.06011891 -1.4007874  1 #> 5  1 1 -0.38970663  0.1602775  1 #> 6  1 1  1.52098616 -0.2739624  0"},{"path":"/reference/split_gmert_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Train/test split by cluster for GMERT data ‚Äî split_gmert_data","title":"Train/test split by cluster for GMERT data ‚Äî split_gmert_data","text":"Splits clustered dataset training test sets preserving cluster structure. cluster contributes proportion observations training test sets.","code":""},{"path":"/reference/split_gmert_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Train/test split by cluster for GMERT data ‚Äî split_gmert_data","text":"","code":"split_gmert_data(df, train_prop = 0.7, seed = 123)"},{"path":"/reference/split_gmert_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Train/test split by cluster for GMERT data ‚Äî split_gmert_data","text":"df data.frame containing clustered observations. Must include column named id. train_prop Numeric. Proportion observations per cluster use training. seed Integer. Random seed reproducibility.","code":""},{"path":"/reference/split_gmert_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Train/test split by cluster for GMERT data ‚Äî split_gmert_data","text":"list two elements: train Training data.frame test Test data.frame","code":""},{"path":[]},{"path":"/reference/split_gmert_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Train/test split by cluster for GMERT data ‚Äî split_gmert_data","text":"","code":"data <- sim_data_gmert() split <- split_gmert_data(data) nrow(split$train) #> [1] 1400 nrow(split$test) #> [1] 600"}]
